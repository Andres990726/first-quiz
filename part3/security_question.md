## Sistema de seguridad

Para hacer que la aplicación sea segura primero hay que revisar las posibles Vulnerabilidades, Por esto vamos a revisar el top 10 de OWASTP

- A01:2021 - Pérdida de Control de Acceso: Debe asegurarse de que solo los usuarios autorizados puedan acceder a los recursos y funciones adecuados. Por ejemplo, debe verificar que los empleados de atención al cliente no puedan modificar la base de datos o el código de la aplicación, que los clientes no puedan ver o cambiar la información de otros clientes, y que los empleados de ingeniería de software tengan una autenticación fuerte y un registro de auditoría de sus acciones.
- A02:2021 - Fallas Criptográficas: Debe asegurarse de que la información confidencial del cliente, como las contraseñas, las direcciones particulares y los números de teléfono, esté cifrada tanto en tránsito como en reposo. Por ejemplo, debe utilizar protocolos seguros como HTTPS y TLS para la comunicación entre la aplicación móvil, la interfaz web y el backend, y debe utilizar algoritmos de cifrado robustos y claves seguras para almacenar los datos en la base de datos. También debe evitar el uso de componentes criptográficos obsoletos o vulnerables, como algoritmos débiles, claves codificadas o certificados autofirmados.
- A03:2021 - Inyección: Debe asegurarse de que su aplicación no sea vulnerable a ataques de inyección, que pueden permitir a un atacante ejecutar comandos maliciosos en su sistema. Por ejemplo, debe validar y desinfectar todas las entradas del usuario, utilizar consultas parametrizadas o procedimientos almacenados para acceder a la base de datos, y evitar la construcción dinámica de comandos o consultas. Los tipos de inyección más comunes son SQL, NoSQL, OS y LDAP, pero también debe tener en cuenta otros tipos, como el Cross-Site Scripting (XSS), que puede afectar a la interfaz web y a las aplicaciones móviles.
- A04:2021 - Diseño Inseguro: Debe asegurarse de que su aplicación tenga un diseño seguro desde el principio, que tenga en cuenta los posibles escenarios de amenaza y que aplique los principios y patrones de seguridad adecuados. Por ejemplo, debe utilizar una arquitectura de mínimos privilegios, que limite el acceso y la exposición de los componentes críticos, debe implementar mecanismos de defensa en profundidad, que proporcionen capas de protección contra los ataques, y debe seguir las mejores prácticas de codificación segura, que eviten las vulnerabilidades comunes y faciliten la prueba y la revisión de la seguridad.
- A05:2021 - Configuración de Seguridad Incorrecta: Debe asegurarse de que su aplicación y su infraestructura estén configuradas correctamente para evitar brechas de seguridad. Por ejemplo, debe deshabilitar o eliminar los servicios, cuentas y puertos innecesarios, debe actualizar y parchear regularmente los componentes de software, debe establecer políticas de seguridad estrictas para los contenedores de Kubernetes y los servicios de AWS, y debe supervisar y auditar el estado y el rendimiento de su sistema. También debe evitar el uso de componentes con vulnerabilidades conocidas, como bibliotecas de terceros obsoletas o dependencias con CVEs reportados.
- A06:2021 - Componentes Vulnerables y Desactualizados: Debe asegurarse de que los componentes que utiliza en su aplicación, como las bibliotecas, los marcos y las dependencias, no tengan vulnerabilidades conocidas que puedan ser explotadas por los atacantes. Por ejemplo, debe mantener un inventario actualizado de los componentes que utiliza, debe verificar su origen y su integridad, debe utilizar herramientas de análisis de vulnerabilidades o de gestión de dependencias para identificar y resolver los problemas, y debe seguir un proceso de actualización y reemplazo seguro para los componentes obsoletos o inseguros.
- A07:2021 - Identificación y Gestión de Identidades Insuficientes: Debe asegurarse de que su aplicación proporcione una identificación y una gestión de identidades adecuadas para los usuarios y los actores del sistema. Por ejemplo, debe implementar un mecanismo de autenticación fuerte y seguro, que utilice factores múltiples, contraseñas robustas y protección contra ataques de fuerza bruta, debe proporcionar una funcionalidad de autorización basada en roles, que asigne permisos adecuados a los usuarios según el principio de mínimos privilegios, y debe gestionar el ciclo de vida de las sesiones y las identidades, que incluya el registro, la recuperación, la revocación y la caducidad.
- A08:2021 - Ingeniería Social y Ataques de Phishing: Debe asegurarse de que su aplicación y su organización estén preparadas para hacer frente a los ataques de ingeniería social y phishing, que pueden engañar a los usuarios o a los empleados para que revelen información confidencial o realicen acciones maliciosas. Por ejemplo, debe educar y concienciar a los usuarios y a los empleados sobre los riesgos y las señales de estos ataques, debe implementar medidas de seguridad como la verificación de la identidad, el cifrado de las comunicaciones y la firma digital de los mensajes, y debe establecer procedimientos de respuesta y recuperación en caso de que se produzca un incidente.
- A09:2021 - Protección de APIs Insuficiente: Debe asegurarse de que su API de backend, que proporciona datos tanto a la interfaz web como a las aplicaciones móviles, esté protegida adecuadamente contra los ataques. Por ejemplo, debe diseñar e implementar su API siguiendo los estándares y las especificaciones de seguridad, debe utilizar mecanismos de autenticación y autorización específicos para la API, debe aplicar controles de acceso y de validación de entrada a los puntos finales y a los parámetros de la API, y debe monitorizar y auditar el uso y el rendimiento de la API.
- A10:2021 - Falsificación de Peticiones al Servidor (SSRF): Debe asegurarse de que su aplicación no sea vulnerable a los ataques de SSRF, que pueden permitir a un atacante enviar peticiones maliciosas desde su servidor a otros sistemas internos o externos. Por ejemplo, debe restringir o filtrar las direcciones URL o los dominios a los que se puede acceder desde su aplicación, debe validar y desinfectar las entradas del usuario que se utilizan para construir las peticiones, y debe utilizar listas de permitidos o de bloqueo para los servicios o los puertos a los que se puede acceder.

Para que la aplicación sea seguroa, se debe utilizar las medidas de seguridad adecuadas para cada uno de los problemas de seguridad mencionados anteriormente. Algunos ejemplos de medidas de seguridad son:

- Para el A01:2021 - Pérdida de Control de Acceso, puede utilizar un sistema de gestión de identidades y accesos (IAM) que le permita definir y aplicar políticas de acceso basadas en roles, grupos y atributos. También puede utilizar herramientas de administración de privilegios, como el servicio AWS Secrets Manager, que le permita almacenar y rotar las credenciales de acceso de forma segura.
- Para el A02:2021 - Fallas Criptográficas, puede utilizar herramientas de cifrado y gestión de claves, como el servicio AWS Key Management Service (KMS), que le permita crear y controlar las claves de cifrado utilizadas para proteger sus datos. También puede utilizar herramientas de análisis de configuración, como el servicio AWS Security Hub, que le permita verificar y mejorar la configuración de seguridad de sus recursos de AWS.
- Para el A03:2021 - Inyección, puede utilizar herramientas de protección de aplicaciones web, como el servicio AWS WAF, que le permita crear reglas personalizadas para bloquear o permitir las solicitudes web que contengan cargas útiles de inyección. También puede utilizar herramientas de análisis de código estático, como el servicio AWS CodeGuru Reviewer, que le permita detectar y corregir las vulnerabilidades de inyección en su código fuente.
- Para el A04:2021 - Diseño Inseguro, puede utilizar herramientas de modelado de amenazas, como el servicio AWS Threat Modeling Tool, que le permita identificar y mitigar los riesgos de seguridad en su arquitectura. También puede utilizar herramientas de automatización de seguridad, como el servicio AWS CloudFormation, que le permita implementar y gestionar su infraestructura de forma segura y consistente.
- Para el A05:2021 - Configuración de Seguridad Incorrecta, puede utilizar herramientas de auditoría y cumplimiento, como el servicio AWS Config, que le permita supervisar y registrar los cambios en la configuración de sus recursos de AWS. También puede utilizar herramientas de escaneo de vulnerabilidades, como el servicio AWS Inspector, que le permita evaluar y mejorar la seguridad de sus aplicaciones y servidores.
- Para el A06:2021 - Componentes Vulnerables y Desactualizados, puede utilizar herramientas de gestión de dependencias, como el servicio AWS CodeArtifact, que le permita almacenar y gestionar sus paquetes de software de forma segura y centralizada. También puede utilizar herramientas de monitorización y alerta, como el servicio AWS CloudWatch, que le permita medir y notificar el estado y el rendimiento de sus componentes de software.
- Para el A07:2021 - Identificación y Gestión de Identidades Insuficientes, puede utilizar herramientas de autenticación y autorización, como el servicio AWS Cognito, que le permita proporcionar a sus usuarios un inicio de sesión seguro y una gestión de cuentas. También puede utilizar herramientas de federación de identidades, como el servicio AWS SSO, que le permita integrar y gestionar el acceso de sus usuarios a múltiples aplicaciones y cuentas de AWS.
- Para el A08:2021 - Ingeniería Social y Ataques de Phishing, puede utilizar herramientas de protección de correo electrónico, como el servicio AWS SES, que le permita enviar y recibir correos electrónicos de forma segura y fiable. También puede utilizar herramientas de educación y concienciación, como el servicio AWS Security Awareness Training, que le permita capacitar y evaluar a sus usuarios y empleados sobre las mejores prácticas de seguridad.
- Para el A09:2021 - Protección de APIs Insuficiente, puede utilizar herramientas de desarrollo y documentación de APIs, como el servicio AWS API Gateway, que le permita crear y gestionar sus APIs de forma segura y escalable. También puede utilizar herramientas de prueba y validación de APIs, como el servicio AWS API Fuzzer, que le permita detectar y solucionar los problemas de seguridad y calidad de sus APIs.
- Para el A10:2021 - Falsificación de Peticiones al Servidor (SSRF), puede utilizar herramientas de aislamiento y segmentación de redes, como el servicio AWS VPC, que le permita crear y controlar las redes virtuales privadas para sus recursos de AWS. También puede utilizar herramientas de detección y prevención de intrusiones, como el servicio AWS GuardDuty, que le permita identificar y responder a las actividades maliciosas en su entorno de AWS.